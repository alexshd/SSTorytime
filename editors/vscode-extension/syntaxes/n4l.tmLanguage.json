{
  "name": "N4L",
  "scopeName": "source.n4l",
  "fileTypes": ["n4l"],
  "patterns": [
    {
      "include": "#comments"
    },
    {
      "include": "#sections"
    },
    {
      "include": "#contexts"
    },
    {
      "include": "#content-blocks"
    },
    {
      "include": "#todos"
    },
    {
      "include": "#aliases"
    },
    {
      "include": "#references"
    },
    {
      "include": "#relationships"
    },
    {
      "include": "#special-markers"
    },
    {
      "include": "#sequence-markers"
    },
    {
      "include": "#ditto-continuation"
    },
    {
      "include": "#strings"
    },
    {
      "include": "#urls"
    },
    {
      "include": "#all-caps-reminders"
    }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.hash.n4l",
          "match": "#.*$"
        },
        {
          "name": "comment.line.double-slash.n4l",
          "match": "//.*$"
        }
      ]
    },
    "sections": {
      "name": "entity.name.section.n4l",
      "match": "^\\s*(-\\s+)(.+?)(?:\\s*#.*)?$",
      "captures": {
        "1": {
          "name": "punctuation.definition.section.n4l"
        },
        "2": {
          "name": "markup.heading.section.n4l"
        }
      }
    },
    "contexts": {
      "name": "entity.name.tag.context.n4l",
      "match": "^\\s*([+\\-]?)(:{2,})\\s*(.+?)\\s*(:{2,})\\s*(#.*)?$",
      "captures": {
        "1": {
          "name": "keyword.operator.context.modifier.n4l"
        },
        "2": {
          "name": "punctuation.definition.context.begin.n4l"
        },
        "3": {
          "name": "markup.bold.context.content.n4l"
        },
        "4": {
          "name": "punctuation.definition.context.end.n4l"
        },
        "5": {
          "name": "comment.line.hash.n4l"
        }
      }
    },
    "content-blocks": {
      "patterns": [
        {
          "name": "entity.name.tag.alias.n4l",
          "match": "^\\s*(@[a-zA-Z_][a-zA-Z0-9_\\.]*)",
          "captures": {
            "1": {
              "name": "support.type.alias.n4l"
            }
          }
        }
      ]
    },
    "sequence-markers": {
      "patterns": [
        {
          "name": "keyword.control.sequence.start.n4l",
          "match": "\\+::"
        },
        {
          "name": "keyword.control.sequence.end.n4l",
          "match": "\\-::"
        }
      ]
    },
    "ditto-continuation": {
      "name": "keyword.operator.continuation.ditto.n4l",
      "match": "^\\s*(\")\\s+(?=\\()"
    },
    "todos": {
      "name": "markup.bold.todo.n4l",
      "match": "\\b([A-Z][A-Z0-9]+(?:\\s+[A-Z][A-Z0-9]+){2,})\\b"
    },
    "all-caps-reminders": {
      "name": "markup.italic.emphasis.reminder.n4l",
      "match": "\\b([A-Z][A-Z]+(?:\\s+[A-Z][A-Z]+){2,})\\b"
    },
    "aliases": {
      "name": "entity.name.constant.alias.n4l",
      "match": "@([a-zA-Z_][a-zA-Z0-9_\\.]*)",
      "captures": {
        "1": {
          "name": "variable.other.constant.alias.n4l"
        }
      }
    },
    "references": {
      "patterns": [
        {
          "name": "variable.other.reference.prev.n4l",
          "match": "\\$(PREV\\.[0-9]+)"
        },
        {
          "name": "variable.other.reference.numbered.n4l",
          "match": "\\$([0-9]+)"
        },
        {
          "name": "variable.other.reference.alias.n4l",
          "match": "\\$([a-zA-Z_][a-zA-Z0-9_]*(?:\\.[0-9]+)?)"
        }
      ]
    },
    "relationships": {
      "patterns": [
        {
          "name": "entity.name.function.relation.valid.n4l",
          "match": "\\(([a-z][a-z\\s,;:.\\-'/]*[a-z])\\)",
          "captures": {
            "0": {
              "name": "punctuation.definition.relation.n4l"
            },
            "1": {
              "name": "string.unquoted.relation.name.n4l"
            }
          }
        },
        {
          "name": "invalid.illegal.relation.invalid.n4l",
          "match": "\\(([^)]{2,})\\)",
          "captures": {
            "0": {
              "name": "punctuation.definition.relation.invalid.n4l"
            },
            "1": {
              "name": "invalid.illegal.relation.content.n4l"
            }
          }
        }
      ]
    },
    "special-markers": {
      "patterns": [
        {
          "name": "entity.name.type.concept.n4l",
          "match": "%([a-zA-Z_][a-zA-Z0-9_\"\\s]*)",
          "captures": {
            "1": {
              "name": "variable.other.concept.n4l"
            }
          }
        },
        {
          "name": "markup.bold.special.n4l",
          "match": "=([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": {
              "name": "variable.other.special.n4l"
            }
          }
        },
        {
          "name": "markup.italic.emphasis.n4l",
          "match": "\\*([a-zA-Z_][a-zA-Z0-9_]*)",
          "captures": {
            "1": {
              "name": "variable.other.emphasis.n4l"
            }
          }
        },
        {
          "name": "keyword.operator.annotation.n4l",
          "match": "(?:^|\\s)(\\*\\*|>>|>|<)(?=\\s)"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.double.n4l",
          "begin": "\"",
          "end": "\"",
          "patterns": [
            {
              "name": "constant.character.escape.n4l",
              "match": "\\\\."
            }
          ]
        }
      ]
    },
    "urls": {
      "name": "markup.underline.link.n4l",
      "match": "https?://[^\\s\"')}]+"
    }
  }
}
